from matplotlib.patches import Polygon
import pyproj
from spherical_geometry.polygon import SphericalPolygon
from mpl_toolkits.basemap import Basemap
import matplotlib.pyplot as plt
import numpy as np
import os
from matplotlib.patches import Polygon
from matplotlib import patches
from matplotlib.collections import LineCollection, PolyCollection
savedir = '/home/laojin/my_lat/basemap/'
if os.path.exists(savedir) == False:
	os.makedirs(savedir)


poly = SphericalPolygon.from_cone(0,0,15,steps=50)
x,y = [p for p in poly.to_radec()][0]

poly1 = SphericalPolygon.from_cone(0,90,15,steps=50)
x1,y1 = [p for p in poly1.to_radec()][0]

xx = np.concatenate((x,x1))
yy = np.concatenate((y,y1))
#print(x,y)
xx1 = [129.8028304243715, 128.90606618300365, 128.01297965969397, 127.12350951826801, 126.23758979932462, 125.35514987727028, 124.47611439113487, 123.6004031448426, 122.72793097184197, 121.85860755804885, 120.99233721587744, 120.1290186006664, 119.2685443589721, 118.41080069589775, 117.55566684571839, 116.70301442637232, 115.85270665367669, 115.00459738507416, 114.1585299548836, 113.31433575282468, 112.47183248417856, 111.63082203218907, 110.79108781957181, 109.95239153396118, 109.1144690384381, 108.27702522803811, 107.43972750906661, 106.60219745919782, 105.76400005594616, 104.9246296130989, 104.08349119770938, 103.23987574727416, 102.39292625678974, 101.5415910700881, 100.68455816038676, 99.82016072974912, 98.94623839467927, 98.05992752403476, 97.15733464673617, 96.23300908804895, 95.27905446745375, 94.28355349546365, 93.2275956733879, 92.07921255029073, 90.77968350739975, 89.20806422662208, 87.06910997367603, 83.4050066600973, 72.4988080459761, 314.22449367221606, 280.1074774702129, 274.44701251288126, 271.75796836432573, 269.96013448132845, 268.54624958180966, 267.3322497397882, 266.2352816234263, 265.2125343022283, 264.2396394324416, 263.3016893080524, 262.3890375944198, 261.49515418854503, 260.61545043577894, 259.74659856040165, 258.8861186695964, 258.0321181613654, 257.18312173508997, 256.33795727504923, 255.49567730125224, 254.65550369946178, 253.81678806611902, 252.9789827583742, 252.14161942816057, 251.30429288150938, 250.46664878807465, 249.62837421525975, 248.7891902623698, 247.94884627537192, 247.10711526489024, 246.2637902498565, 245.41868132029373, 244.57161326393702, 243.72242363875984, 242.8709612010124, 242.0170846188898, 241.16066141735774, 240.30156711134927, 239.43968449347884, 238.5749030492962, 237.7071184784412, 236.83623230422396, 235.96215155743283, 235.08478852275408, 234.2040605382464, 233.3198898399512, 232.43220344503388, 231.54093306791307, 230.64601506468424, 229.74739040184, 228.84500464585028, 227.93880797062127, 227.02875518022574, 226.11480574459924, 225.19692384614524, 224.27507843539203, 223.34924329401017, 222.419397103631, 221.48552351901657, 220.54761124421958, 219.60565411044334, 218.65965115437155, 217.7096066957857, 216.75553041332918, 215.79743741731187, 214.8353483184803, 213.86928929170628, 212.8992921335747, 211.92539431287904, 210.94763901306035, 209.96607516565876, 208.98075747387762, 207.99174642539964, 206.99910829363657, 206.00291512663802, 205.00324472294025, 204.0001805936906, 202.99381191044685, 201.9842334381207, 200.97154545260705, 199.95585364272273, 198.93726899616252, 197.91590766927177, 196.89189084052813, 195.8653445477258, 194.83639950895628, 193.80519092758402, 192.77185828152264, 191.7365450972232, 190.69939870889232, 189.6605700035641, 188.62021315275172, 187.57848533150408, 186.53554642578794, 185.49155872920454, 184.44668663013294, 183.40109629046697, 182.35495531717888, 181.30843242800077, 180.26169711256142, 179.21491929035332, 178.16826896693053, 177.1219158897513, 176.07602920508478, 175.03077711738877, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 175.08609985328465, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 174.98609985328466, 171.90048931940808, 170.85942716007622, 169.81981491611964, 168.7818082966896, 167.74555986541097, 166.71121876562705, 165.67893045866444, 164.64883647589338, 163.62107418525986, 162.59577657285948, 161.57307204001867, 160.55308421624156, 159.53593178827396, 158.5217283454312, 157.5105822412324, 156.50259647128425, 155.49786856725913, 154.49649050672122, 153.49854863846502, 152.5041236229488, 151.51329038732737, 150.52611809451773, 149.54267012566467, 148.56300407531353, 147.5871717585425, 146.61521922925803, 145.64718680881282, 144.68310912406534, 143.72301515396586, 142.7669282837202, 141.81486636555368, 140.86684178506968, 139.92286153216952, 138.98292727547317, 138.04703543915014, 137.11517728103848, 136.18733897088978, 135.26350166753667, 134.34364159372294, 133.42773010727305, 132.51573376719784, 131.60761439323406, 130.7033291171963]
yy1 = [49.42040165915906, 50.11513391272762, 50.81867989129425, 51.530833088336244, 52.25138761334855, 52.98013826786612, 53.71688061481867, 54.46141104138225, 55.21352681550065, 55.97302613625347, 56.739708178251455, 57.513373130241504, 58.29382222810226, 59.08085778240962, 59.87428320074649, 60.67390300492312, 61.47952284326611, 62.29094949811898, 63.10799088868135, 63.930456069290294, 64.75815522321821, 65.59089965202435, 66.4285017604459, 67.27077503674943, 68.11753402837373, 68.96859431257404, 69.8237724616113, 70.6828860017943, 71.5457533653502, 72.4121938336146, 73.2820274693198, 74.1550750346883, 75.03115789039443, 75.91009786787706, 76.79171710333556, 77.67583781487923, 78.56228199260137, 79.45087095069925, 80.34142465284546, 81.23376064914079, 82.12769231525714, 83.02302576539653, 83.91955406730989, 84.8170454839175, 85.7152169691001, 86.61366552933026, 87.51165108000515, 88.40714671653461, 89.28872981523494, 89.6844466907027, 88.85174396504127, 87.95996424329572, 87.06278970014336, 86.16444034105314, 85.26606725544737, 84.36819539032932, 83.47115425816834, 82.5751963485372, 81.6805389214997, 80.78738140291297, 79.89591353914646, 79.00631958469953, 78.11878061598117, 77.23347589046031, 76.35058368853615, 75.47028186026792, 74.59274819609549, 73.71816068843695, 72.8466977232168, 71.97853822490643, 71.11386176973453, 70.25284867640897, 69.39568008042833, 68.54253799600811, 67.69360536832443, 66.84906611790312, 66.00910517839985, 65.17390852861338, 64.34366321929662, 63.51855739513179, 62.69878031209425, 61.88452235032577, 61.07597502256163, 60.27333097809811, 59.47678400224366, 58.68652901116352, 57.90276204200194, 57.12568023814633, 56.355481829482564, 55.592366107478824, 54.83653339492709, 54.08818501016543, 53.347523225600646, 52.61475122034914, 51.89007302681478, 51.17369347102413, 50.46581810654458, 49.76665314181577, 49.07640536073392, 48.39528203633719, 47.72349083745283, 47.06123972818015, 46.40873686009905, 45.76619045711189, 45.13380869284574, 44.51179956056489, 43.90037073556687, 43.29972943006149, 42.710082240561626, 42.13163498784367, 41.564592549569134, 41.00915868569266, 40.46553585681835, 39.93392503570412, 39.41452551215376, 38.90753469157674, 38.41314788753869, 37.931558108668106, 37.46295584032871, 37.0075288215112, 36.56546181744202, 36.136936388450785, 35.72213065568111, 35.3212190642715, 34.93437214467354, 34.56175627281326, 34.203533429837314, 33.859860962219315, 33.53089134303131, 33.2167719352118, 32.917644757683576, 32.633646255192446, 32.36490707274999, 32.111551835571376, 31.873698935400007, 31.651460324107777, 31.44494131544817, 31.254240395823828, 31.079449044907236, 30.920651566923976, 30.777924933372883, 30.651338637915806, 30.54095456412283, 30.44682686670515, 30.36900186681022, 30.307517961890408, 30.262405550588614, 30.233686973013505, 30.221376466701948, 30.225480138489097, 30.245995952427396, 30.28291373381529, 30.336215189315308, 30.4058739430604, 31.205995477386935, 32.110517085427134, 33.01503869346733, 33.919560301507545, 34.82408190954774, 35.72860351758794, 36.63312512562814, 37.53764673366834, 38.44216834170854, 39.346689949748736, 40.251211557788935, 41.15573316582913, 42.06025477386936, 42.96477638190956, 43.86929798994976, 44.773819597989956, 45.678341206030154, 46.58286281407035, 47.48738442211055, 48.39190603015075, 49.29642763819095, 50.20094924623115, 51.105470854271346, 52.009992462311544, 52.91451407035177, 53.81903567839197, 54.72355728643217, 55.62807889447237, 56.532600502512565, 57.437122110552764, 58.34164371859296, 59.24616532663316, 60.15068693467336, 61.05520854271356, 61.95973015075376, 62.86425175879398, 63.76877336683418, 64.67329497487438, 65.57781658291458, 66.48233819095478, 67.38685979899498, 68.29138140703517, 69.19590301507537, 70.10042462311557, 71.00494623115577, 71.90946783919597, 72.81398944723617, 73.7185110552764, 74.6230326633166, 75.52755427135679, 76.43207587939699, 77.33659748743719, 78.24111909547739, 79.14564070351759, 80.05016231155778, 80.95468391959798, 81.85920552763818, 82.76372713567838, 83.66824874371858, 84.5727703517588, 85.477291959799, 86.3818135678392, 87.2863351758794, 88.1908567839196, 89.0953783919598, 89.9999, 89.9999, 89.0953783919598, 88.1908567839196, 87.2863351758794, 86.3818135678392, 85.477291959799, 84.5727703517588, 83.66824874371858, 82.76372713567838, 81.85920552763818, 80.95468391959798, 80.05016231155778, 79.14564070351759, 78.24111909547739, 77.33659748743719, 76.43207587939699, 75.52755427135679, 74.6230326633166, 73.7185110552764, 72.81398944723617, 71.90946783919597, 71.00494623115577, 70.10042462311557, 69.19590301507537, 68.29138140703517, 67.38685979899498, 66.48233819095478, 65.57781658291458, 64.67329497487438, 63.76877336683418, 62.86425175879398, 61.95973015075376, 61.05520854271356, 60.15068693467336, 59.24616532663316, 58.34164371859296, 57.437122110552764, 56.532600502512565, 55.62807889447237, 54.72355728643217, 53.81903567839197, 52.91451407035177, 52.009992462311544, 51.105470854271346, 50.20094924623115, 49.29642763819095, 48.39190603015075, 47.48738442211055, 46.58286281407035, 45.678341206030154, 44.773819597989956, 43.86929798994976, 42.96477638190956, 42.06025477386936, 41.15573316582913, 40.251211557788935, 39.346689949748736, 38.44216834170854, 37.53764673366834, 36.63312512562814, 35.72860351758794, 34.82408190954774, 33.919560301507545, 33.01503869346733, 32.110517085427134, 31.205995477386935, 76.43207587939699, 77.33659748743719, 78.24111909547739, 79.14564070351759, 80.05016231155778, 80.95468391959798, 81.85920552763818, 82.76372713567838, 83.66824874371858, 84.5727703517588, 85.477291959799, 86.3818135678392, 87.2863351758794, 88.1908567839196, 89.0953783919598, 89.9999, 89.9999, 89.0953783919598, 88.1908567839196, 87.2863351758794, 86.3818135678392, 85.477291959799, 84.5727703517588, 83.66824874371858, 82.76372713567838, 81.85920552763818, 80.95468391959798, 80.05016231155778, 79.14564070351759, 78.24111909547739, 77.33659748743719, 76.43207587939699, 30.712610195838806, 30.847274874364505, 30.998046087457812, 31.164850585187608, 31.347607710775673, 31.546229551880476, 31.76062110368984, 31.99068044306816, 32.236298912965324, 32.49736131626284, 32.77374611820601, 33.06532565655199, 33.37196635854994, 33.69352896386232, 34.029868752535215, 34.380835777129704, 34.746275098136934, 35.126027021813684, 35.519927339595874, 35.92780756827109, 36.349495190119804, 36.784813892266044, 37.23358380451377, 37.69562173498186, 38.17074140289084, 38.65875366789506, 39.15946675539755, 39.67268647732732, 40.1982164479038, 40.735858293956696, 41.28541185941385, 41.84667540361291, 42.41944579313568, 43.003518686905124, 43.59868871432577, 44.20474964628687, 44.82149455888474, 45.44871598975659, 46.08620608695092, 46.7337567502916, 47.39115976522202, 48.05820692914277, 48.73469017028186]

plt.plot(xx1,yy1)
plt.xlim(174.98609985328466-1,174.98609985328466+1)
plt.axvline(x=174.98609985328466,color = 'r')
plt.savefig(savedir+ 'A_ccc.png')
plt.close()
#xx1 = [245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.05199896846096, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 245.04199896846097, 247.5979786628817, 248.99847895667045, 250.34636983917915, 251.6474764079201, 252.90732726396186, 254.13122935659976, 255.32435039878695, 256.4918123539396, 257.6388013598188, 258.77070214087, 259.8932690425068, 261.0128522774758, 262.1367085367857, 263.27344296898127, 264.4336607600497, 265.63096330666804, 266.88353173499536, 268.2167556796261, 269.6678210708618, 271.29420712234935, 273.1906106832009, 275.52589528743204, 278.6340253087111, 283.2774625017068, 291.60760838277537, 311.87704235057356, 9.911587838452505, 56.00772515029007, 71.29444363464722, 78.22468497150791, 82.3246943332868, 85.17160983774363, 87.3631166830078, 89.1729457855769, 90.7439329002498, 92.15809384593382, 93.46615069380223, 94.7014323928957, 95.88700544471794, 97.03959156808642, 98.17184527532359, 99.29374300053763, 100.41346667040028, 101.53798752560533, 102.67346600990405, 103.82553554430427, 104.99951130530667, 106.2005497146902, 107.43377514714766, 108.7043846869067, 110.01773814035485, 111.37943809621063, 112.79540311576594, 114.27193581705075, 115.8157864740096, 117.434211624201, 119.13502593121655, 120.92664405615338, 122.81810743507566, 124.81908852302985, 126.93986216156668, 129.19123023124547, 131.5843817718942, 134.1306666454086, 136.84125733950643, 139.7266720348858, 142.7961347475889, 146.0567582203854, 149.51255578576524, 153.16332262277655, 157.0034750206056, 161.0209931810586, 165.1966650776178, 169.50385369022376, 173.90898221199586, 178.37283551582556, 182.85261953809442, 187.3045432725953, 191.68655189208857, 195.9607982280623, 200.09551079271506, 204.06607015768168, 207.85528248798153, 211.45298180032927, 214.85516959664858, 218.06291159745268, 221.08117649567424, 223.9177464236438, 226.58227332935797, 229.0855108702316, 231.43872116313906, 233.65323845289782, 235.74016420274268, 237.71016682648968, 239.5733614845788, 241.3392491220277, 243.0166980539551, 244.61395527305194]
#yy1 = [-0.9090898989898903, -2.7272696969696995, -4.545449494949494, -6.363629292929289, -8.181809090909084, -9.999988888888879, -11.818168686868688, -13.636348484848483, -15.454528282828278, -17.272708080808073, -19.090887878787868, -20.909067676767677, -22.72724747474747, -24.545427272727267, -26.36360707070707, -28.181786868686864, -29.999966666666666, -31.81814646464646, -33.636326262626255, -35.45450606060606, -37.27268585858585, -39.090865656565654, -40.90904545454545, -42.72722525252525, -44.545405050505046, -46.36358484848485, -48.18176464646464, -49.99994444444444, -51.81812424242424, -53.636304040404035, -55.45448383838384, -57.27266363636363, -59.09084343434343, -60.90902323232323, -62.72720303030303, -64.54538282828283, -66.36356262626262, -68.18174242424243, -69.99992222222221, -71.81810202020202, -73.63628181818181, -75.45446161616161, -77.27264141414142, -79.09082121212121, -80.90900101010101, -82.7271808080808, -84.5453606060606, -86.3635404040404, -88.1817202020202, -89.9999, -89.9999, -88.1817202020202, -86.3635404040404, -84.5453606060606, -82.7271808080808, -80.90900101010101, -79.09082121212121, -77.27264141414142, -75.45446161616161, -73.63628181818181, -71.81810202020202, -69.99992222222221, -68.18174242424243, -66.36356262626262, -64.54538282828283, -62.72720303030303, -60.90902323232323, -59.09084343434343, -57.27266363636363, -55.45448383838384, -53.636304040404035, -51.81812424242424, -49.99994444444444, -48.18176464646464, -46.36358484848485, -44.545405050505046, -42.72722525252525, -40.90904545454545, -39.090865656565654, -37.27268585858585, -35.45450606060606, -33.636326262626255, -31.81814646464646, -29.999966666666666, -28.181786868686864, -26.36360707070707, -24.545427272727267, -22.72724747474747, -20.909067676767677, -19.090887878787868, -17.272708080808073, -15.454528282828278, -13.636348484848483, -11.818168686868688, -9.999988888888879, -8.181809090909084, -6.363629292929289, -4.545449494949494, -2.7272696969696995, -0.9090898989898903, -6.2376468590768805, -9.287139999342392, -12.364850610511017, -15.468083816559437, -18.59441573719345, -21.741659221795448, -24.907833546888984, -28.091137470637438, -31.289925048840633, -34.50268360862509, -37.72801323265884, -40.96460700430456, -44.21123106200328, -47.466703135466645, -50.7298675457411, -53.99956336341037, -57.2745799405136, -60.55358904304068, -63.83503218251829, -67.11691745184557, -70.39641959871747, -73.66900860672736, -76.92629244815869, -80.14966956669483, -83.28629441753313, -86.11517582430463, -87.33477310087895, -85.4050046114177, -82.44261917684447, -79.2725118721283, -76.03686136007043, -72.77416526832289, -69.49907441131568, -66.21856513533294, -62.93656558664406, -59.65561413036791, -56.37755551757532, -53.10387004630465, -49.8358450044942, -46.57467194091949, -43.32150660150296, -40.07750914687485, -36.843873681486826, -33.621852026313555, -30.412774603370256, -27.218070217216376, -24.0392859344178, -20.87810794405399, -17.736384113048175, -14.616148866972562, -11.51965099514779, -8.449384977222357, -5.408126442363988, -2.3989723892948067, 0.5746131976091559, 3.508747720737988, 6.399071784147644, 9.240684055768787, 12.028069058665253, 14.755018236990534, 17.41454537386618, 19.998798539359566, 22.49897233601217, 24.90522640898928, 27.20661909031695, 29.39106865288673, 31.445358768146658, 33.355208863601106, 35.10543313416368, 36.68021233168312, 38.06349795407699, 39.23955681062134, 40.19364380913663, 40.91276325128975, 41.38644875214066, 41.60746781716384, 41.57234945221029, 41.281649361976974, 40.739906965611425, 39.955301772594495, 38.939067682086616, 37.7047576064154, 36.2674601104432, 34.64305664618256, 32.84758118643366, 30.896713886637997, 28.805414575517304, 26.587684092790592, 24.256431999344592, 21.823426251914228, 19.299301739108945, 16.69360805592405, 14.014881078684954, 11.270726915769238, 8.467910231627155, 5.612441646177945, 2.709660932911587, -0.2356858177876197]


fig = plt.figure()
ax = fig.add_subplot(1,1,1)
e1 = patches.Ellipse((0, 0), 15,15,angle=0, linewidth=2, fill=False, zorder=2)


map = Basemap(projection='moll',lat_0=0,lon_0=180,resolution = 'l',area_thresh=1000.0,celestial=True,ax = ax)
#xxx = map.tissot(0,50,60,30,facecolor='coral',edgecolor='coral',linewidth=0)
#map.drawgreatcircle(0,0,50,50)
xx,yy = map(xx,yy)
new_xy = list(zip(xx,yy))
xxx,yyy = map(xx1,yy1)
map.plot(xxx,yyy)


xxx,yyy = map(xx1[0],yy1[0])
print(xx1[0],yy1[0])
map.plot(xxx,yyy,'o')
xxx,yyy = map(xx1[20],yy1[20])
print(xx1[20],yy1[20])
map.plot(xxx,yyy,'o')
xxx,yyy = map(xx1[80],yy1[80])
print(xx1[80],yy1[80])
map.plot(xxx,yyy,'o')

xxx,yyy = map(xx1[100],yy1[100])
print(xx1[100],yy1[100])
map.plot(xxx,yyy,'o')
coords = [new_xy]
lines = LineCollection(coords,antialiaseds=(1,))
#ax.add_collection(lines)
#print(xxx)
poly1 = Polygon(new_xy,facecolor='coral',edgecolor='coral',linewidth=0)
polys = [poly1]

ax.add_patch(poly1)
ax.add_patch(e1)
ax.add_patch(xxx)
#map.drawcoastlines(linewidth=0.25)
#map.drawcountries(linewidth=0.25)
#map.fillcontinents(color='coral',lake_color='aqua')
# draw the edge of the map projection region (the projection limb)
#map.drawmapboundary(fill_color='aqua')
# draw lat/lon grid lines every 30 degrees.

map.drawmeridians(np.arange(-180,180,30),dashes=[1,0],color='#d9d6c3')
map.drawparallels(np.arange(-90,90,30),dashes=[1,0], labels=[1,0,0,1], color='#d9d6c3')
# make up some data on a regular lat/lon grid.
#nlats = 73; nlons = 145; delta = 2.*np.pi/(nlons-1)
#print(np.indices((nlats,nlons))[0,:,:])
#lats = (0.5*np.pi-delta*np.indices((nlats,nlons))[0,:,:])
#lons = (delta*np.indices((nlats,nlons))[1,:,:])
#wave = 0.75*(np.sin(2.*lats)**8*np.cos(4.*lons))
#mean = 0.5*np.cos(2.*lats)*((np.sin(2.*lats))**2 + 2.)
#compute native map projection coordinates of lat/lon grid.
#x, y = map(lons*180./np.pi, lats*180./np.pi)
# contour data over the map.
#cs = map.contour(x,y,wave+mean,15,linewidths=1.5)
plt.title('contour lines over filled continent background')
plt.savefig(savedir + 'A_basemap.png')
plt.close()

i, j = np.indices((2,3))
print('----------------------')
print(i)
print(j)
